<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Underground Railroad Scanner</title>

    <link rel="stylesheet" href="leaflet.css" />

    <style>
      body,
      html {
        margin: 0;
        padding: 0;
        height: 100%;
        width: 100%;
        display: flex;
        background: #000;
        overflow: hidden;
      }

      #welcome-modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.95);
        z-index: 2000;
        display: flex;
        align-items: center;
        justify-content: center;
        font-family: "Courier New", monospace;
        box-shadow: 0 0 30px rgba(128, 0, 128, 0.5);
      }
      .modal-content {
        background: #1a1a1a;
        padding: 40px;
        border: 2px solid #800000;
        text-align: center;
        max-width: 600px;
        color: #fbfbfb;
        box-shadow: 0 0 30px rgba(128, 0, 128, 0.5);
      }
      .modal-content button {
        background: transparent;
        color: #ff0000;
        border: 1px solid #ff0000;
        padding: 12px 25px;
        cursor: pointer;
        margin-top: 25px;
        font-family: "Courier New", monospace;
        font-weight: bold;
        transition: 0.3s;
      }
      .modal-content button:hover {
        background: #ff0000;
        color: #000;
        box-shadow: 0 0 30px rgba(128, 0, 128, 0.5);
      }

      #sidebar {
        width: 300px;
        background: #1a1a1a;
        color: #fe1313;
        font-family: "Courier New", monospace;
        padding: 20px;
        border-right: 2px solid #800000;
        z-index: 1100;
        display: flex;
        flex-direction: column;
        height: 100vh;
        box-shadow: 0 0 30px rgba(128, 0, 128, 0.5);
      }

      .scroll-section {
        flex: 1;
        overflow-y: auto;
        margin-bottom: 20px;
      }

      #haven-list {
        list-style: none;
        padding: 0;
      }
      .haven-item {
        padding: 10px;
        margin: 5px 0;
        border: 1px solid #333;
        transition: 0.3s;
        opacity: 0.5;
        font-size: 13px;
        box-shadow: 0 0 30px rgba(128, 0, 0, 0.5);
      }
      .haven-item.found {
        opacity: 1;
        border-color: #51ff00;
        color: #26ff00;
        background: rgba(0, 255, 204, 0.1);
        box-shadow: 0 0 30px rgba(128, 0, 128, 0.5);
      }

      .dictionary-container {
        border-top: 2px solid #800000;
        padding-top: 15px;
      }
      .dictionary-entry {
        margin-bottom: 12px;
        font-size: 12px;
      }
      .term {
        color: #26ff00;
        font-weight: bold;
        display: block;
      }
      .definition {
        color: #ccc;
        display: block;
        margin-top: 2px;
      }

      #map {
        flex-grow: 1;
        height: 100vh;
        background: #060000;
        cursor: crosshair;
        box-shadow: 0 0 30px rgba(128, 0, 128, 0.5);
      }

      .leaflet-tile-pane {
        filter: invert(100%) hue-rotate(180deg) brightness(95%) contrast(90%);
      }

      .ui-overlay {
        position: absolute;
        top: 20px;
        left: calc(50% + 150px);
        transform: translateX(-50%);
        z-index: 1000;
        background: rgba(255, 255, 255, 0.95);
        color: #000;
        padding: 12px 24px;
        border: 2px solid #000;
        font-family: "Courier New", monospace;
        box-shadow: 0 0 30px rgba(128, 0, 128, 0.5);
      }

      .leaflet-secret-pane {
        z-index: 650;
        pointer-events: auto !important;
        filter: drop-shadow(0 0 25px #ff00ff) brightness(1.2);
        clip-path: circle(0px at 0px 0px);
        transition: clip-path 0.05s ease-out;
      }
      .ui-overlay {
        position: absolute;
        top: 20px;
        left: calc(50% + 150px);
        transform: translateX(-50%);
        z-index: 1000;
        background: rgba(0, 0, 0, 0.85);
        color: #ffffff;
        padding: 10px 24px;
        border: 2px solid #800000;
        font-family: "Courier New", monospace;
        display: flex;
        align-items: center;
        gap: 20px;
        min-width: 480px;
        box-shadow: 0 0 30px rgba(128, 0, 128, 0.5);
      }

      #reopen-statement {
        background: transparent;
        color: #ffffff;
        border: 1px solid #ffffff;
        padding: 5px 12px;
        cursor: pointer;
        font-family: "Courier New", monospace;
        font-size: 11px;
        transition: 0.3s;
        box-shadow: 0 0 30px rgba(128, 0, 128, 0.5);
      }

      #reopen-statement:hover {
        background: #ffffff;
        color: #000;
        box-shadow: 0 0 30px rgba(128, 0, 128, 0.5);
      }
    </style>
  </head>
  <body>
    <div id="welcome-modal">
      <div class="modal-content">
        <h1>THE FREEDOM TRAIN EXHIBIT - CURATOR'S STATEMENT</h1>
        <p>
          Welcome to our Exhibit! This exhibit amplifies the voice of Black
          people and changes the perspective that they're passive people. By
          using the 'black light reader' over parts of America and Canada, you
          will find routes from the Underground Railroad and links that will
          lead you to different safe houses and how they were important to the
          Underground Railroad. When you're done looking at everything, you will
          realize how Black people were mistreated but also how they never
          backed down and fought for freedom and equality. - Vimal, Noah, Etthan
        </p>
        <button onclick="closeWelcome()">INITIALIZE SCANNER</button>
      </div>
    </div>

    <div id="sidebar">
      <div class="scroll-section">
        <h2>SAFE HOUSES FOUND</h2>
        <ul id="haven-list"></ul>
      </div>

      <div class="dictionary-container scroll-section">
        <h2>DICTIONARY</h2>
        <div class="dictionary-entry">
          <span class="term">ABOLITIONISTS</span>
          <span class="definition"
            >A person who favors the abolition of a practice or institution,
            especially capital punishment or (formerly) slavery.</span
          >
        </div>
        <div class="dictionary-entry">
          <span class="term">STATION MASTERS</span>
          <span class="definition"
            >An abolitionist or ally who hid escaping enslaved people
            ("passengers") in their homes.</span
          >
        </div>
        <div class="dictionary-entry">
          <span class="term">AGENTS</span>
          <span class="definition"
            >A coordinator or facilitator who helped enslaved people find,
            enter, and navigate the network to freedom.</span
          >
        </div>
        <div class="dictionary-entry">
          <span class="term">FREEDOM SEEKERS</span>
          <span class="definition"
            >The decision of the enslaved person to take control of their
            destiny from the enslaver by leaving the site of enslavement.</span
          >
        </div>
        <div class="dictionary-entry">
          <span class="term">QUAKERS</span>
          <span class="definition"
            >Quakers were people that believed in the equality of everyone.
          </span>
        </div>
      </div>
    </div>

    <div class="ui-overlay" id="ui-box">
      <div style="display: flex; align-items: center; gap: 20px">
        <span>UNDERGROUND RAILROAD: <span id="count">0</span>/10 FOUND</span>
        <button onclick="openWelcome()" id="reopen-statement">
          CURATOR'S STATEMENT
        </button>
      </div>
    </div>

    <div id="map"></div>

    <script src="leaflet.js"></script>

    <script>
      function openWelcome() {
        document.getElementById("welcome-modal").style.display = "flex";
      }
      function closeWelcome() {
        document.getElementById("welcome-modal").style.display = "none";
      }

      window.onload = function () {
        var map = L.map("map").setView([37.0, -92.0], 4);
        L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(
          map,
        );

        var secretPane = map.createPane("secretPane");

        var routeStyle = {
          color: "#ff0000",
          weight: 5,
          dashArray: "10, 15",
          pane: "secretPane",
          opacity: 0.8,
        };

        const routes = [
          [
            [33.7, -84.4],
            [35.6, -82.5],
            [38.4, -76.1],
            [39.9, -75.1],
            [40.7, -74.0],
            [43.1, -79.2],
          ],
          [
            [32.3, -86.3],
            [36.1, -86.7],
            [38.2, -85.7],
            [40.0, -83.0],
            [41.5, -81.7],
            [42.3, -83.0],
          ],
          [
            [30.0, -90.0],
            [34.7, -92.3],
            [38.6, -90.2],
            [41.8, -87.6],
            [43.0, -87.9],
          ],
          [
            [25.7, -80.1],
            [32.7, -79.9],
            [36.8, -76.2],
            [40.7, -74.0],
            [42.3, -71.0],
          ],
          [
            [30.2, -97.7],
            [29.4, -98.4],
            [27.5, -99.5],
          ],
        ];
        routes.forEach((coords) => L.polyline(coords, routeStyle).addTo(map));

        var havens = [
          {
            id: "h1",
            p: [42.5, -82.1],
            n: "Dawn Settlement, ON",
            url: "https://docs.google.com/presentation/d/1RHJ6qVz7Jk6h9nqalcxzoU4UhQ4WeogrspMWw6EEFhY/present?slide=id.g3cb5ba8d504_0_0#slide=id.g3cb5ba8d504_0_0",
          },
          {
            id: "h2",
            p: [42.3, -83.0],
            n: "Detroit, MI (Midnight)",
            url: "https://docs.google.com/presentation/d/1B8xA-Mt7js2kjIOBza3eWLHF7uf5rSYFO4FJe93PUX0/present?slide=id.g3cb5c2db828_0_2#slide=id.g3cb5c2db828_0_2",
          },
          {
            id: "h3",
            p: [43.1, -79.2],
            n: "St. Catharines, ON",
            url: "https://docs.google.com/presentation/d/14qg5638FEj92saP9LpwBy_hxrQ-nSmlYYHv8aor3zO8/present?slide=id.g3cb5b039ec6_0_0#slide=id.g3cb5b039ec6_0_0",
          },
          {
            id: "h4",
            p: [39.9, -75.1],
            n: "Philadelphia, PA",
            url: "https://docs.google.com/presentation/d/1zvq88Lm85cgyNsep_o3ksXqqNZ5KWBBONFDHfTeGDxY/present?slide=id.g3c0cf6ded34_0_0#slide=id.g3c0cf6ded34_0_0",
          },
          {
            id: "h5",
            p: [41.8, -87.6],
            n: "Chicago, IL",
            url: "https://docs.google.com/presentation/d/1eDh_iRgFZLVunGVRq5nejlfKr7ZmtGMHaK0znbLYcNY/present?slide=id.g3cb5c234ac3_0_0#slide=id.g3cb5c234ac3_0_0",
          },
          {
            id: "h6",
            p: [27.5, -99.5],
            n: "Laredo, TX (Mexico)",
            url: "https://docs.google.com/presentation/d/1D5D8puFl4UlPWxZ2ERkt7MHkoGNNHykcirD58B3MyIs/present?slide=id.g3c0cf6d0ffc_0_0#slide=id.g3c0cf6d0ffc_0_0",
          },
          {
            id: "h7",
            p: [38.7, -83.7],
            n: "The Rankin House, OH",
            url: "https://docs.google.com/presentation/d/1sb-khAMpNv-NaRagFfmoP8sn4P1dzc9Y50c9s69DZ3A/present?slide=id.g3cb5c34a8de_0_0#slide=id.g3cb5c34a8de_0_0",
          },
          {
            id: "h8",
            p: [42.3, -71.0],
            n: "Boston, MA",
            url: "https://docs.google.com/presentation/d/14BlgXOMYpJR1tLyCP8frfJ0gU6KpvuLM8Xwj9Cb_Wr0/present?slide=id.g3cb5bcd7250_0_0#slide=id.g3cb5bcd7250_0_0",
          },
          {
            id: "h9",
            p: [25.8, -80.2],
            n: "Miami, FL (Bahamas)",
            url: "https://docs.google.com/presentation/d/1y4n37jrDUHLPXsRkYv-YEJGRn2KGTf-k_6RAfSLxTWU/present?slide=id.g3cb5b8e91be_0_0#slide=id.g3cb5b8e91be_0_0",
          },
          {
            id: "h10",
            p: [44.7, -63.6],
            n: "Africville, NS",
            url: "https://docs.google.com/presentation/d/101dKpazE6dYJTDdbJFzcVQz5ukE-ZCQogphyXVL3Zac/present?slide=id.g3c995130b88_0_1#slide=id.g3c995130b88_0_1",
          },
        ];

        var listContainer = document.getElementById("haven-list");
        var foundPlaces = new Set();
        var foundCount = 0;

        havens.forEach((h) => {
          var li = document.createElement("li");
          li.id = h.id;
          li.className = "haven-item";
          li.innerText = "[ LOCKED ] " + h.n;
          listContainer.appendChild(li);

          var marker = L.circleMarker(h.p, {
            radius: 12,
            fillColor: "#00ffcc",
            color: "#800080",
            weight: 8,
            fillOpacity: 1,
            pane: "secretPane",
          }).addTo(map);

          marker.on("mouseover", function () {
            if (!foundPlaces.has(h.n)) {
              foundPlaces.add(h.n);
              foundCount++;
              document.getElementById("count").innerText = foundCount;
              var listItem = document.getElementById(h.id);
              listItem.classList.add("found");
              listItem.innerText = "[ FOUND ] " + h.n;
              if (foundCount === 10)
                document.getElementById("ui-box").innerText =
                  "ALL HAVENS FOUND!";
            }
          });
          marker.on("click", () => window.open(h.url, "_blank"));
        });

        map.on("mousemove", function (e) {
          var pane = map.getPane("secretPane");
          if (pane) {
            var point = map.mouseEventToLayerPoint(e.originalEvent);
            pane.style.clipPath = `circle(50px at ${point.x}px ${point.y}px)`;
          }
        });
      };
    </script>
  </body>
</html>
